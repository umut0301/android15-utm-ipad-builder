# è‡ªåŠ¨åŒ–è„šæœ¬ä½¿ç”¨æŒ‡å—

## ğŸš€ ä¸€é”®å¼è‡ªåŠ¨åŒ–ç¼–è¯‘

### æœ€ç®€å•çš„æ–¹å¼ï¼šä¸€é”®è¿è¡Œ

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/umut0301/android15-utm-ipad-builder.git
cd android15-utm-ipad-builder

# ä¸€é”®è¿è¡Œï¼ˆå®Œå…¨è‡ªåŠ¨åŒ–ï¼‰
sudo bash scripts/00-auto-build-all.sh
```

**å°±è¿™ä¹ˆç®€å•ï¼** è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»ç¯å¢ƒå‡†å¤‡åˆ°ç¼–è¯‘å®Œæˆçš„æ‰€æœ‰æ­¥éª¤ã€‚

---

## ğŸ“‹ è„šæœ¬åˆ—è¡¨

| è„šæœ¬ | åŠŸèƒ½ | é¢„è®¡æ—¶é—´ | éœ€è¦ sudo |
|------|------|---------|----------|
| `00-auto-build-all.sh` | ä¸€é”®å¼å…¨è‡ªåŠ¨ç¼–è¯‘ | 4-15 å°æ—¶ | âœ“ |
| `01-setup-build-env.sh` | ç¯å¢ƒå‡†å¤‡å’Œä¾èµ–å®‰è£… | 10-20 åˆ†é’Ÿ | âœ“ |
| `02-sync-source.sh` | åŒæ­¥ LineageOS æºä»£ç  | 2-8 å°æ—¶ | âœ— |
| `03-build-android.sh` | ç¼–è¯‘ Android 15 | 1-6 å°æ—¶ | âœ— |
| `04-optimize-output.sh` | ä¼˜åŒ–ç¼–è¯‘äº§ç‰© | 10-20 åˆ†é’Ÿ | âœ— |
| `05-transfer-to-ipad.sh` | ä¼ è¾“æ–‡ä»¶åˆ° iPad | æŒ‰éœ€ | âœ— |

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: é¦–æ¬¡ç¼–è¯‘ï¼ˆæ¨èï¼‰

**ä½¿ç”¨ä¸€é”®å¼è„šæœ¬**ï¼š

```bash
sudo bash scripts/00-auto-build-all.sh
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–
- âœ… æ— éœ€æ‰‹åŠ¨å¹²é¢„
- âœ… è‡ªåŠ¨å¤„ç†æ‰€æœ‰æ­¥éª¤
- âœ… ç»Ÿä¸€çš„æ—¥å¿—è®°å½•

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦é•¿æ—¶é—´è¿è¡Œï¼ˆ4-15 å°æ—¶ï¼‰
- âš ï¸ ä¸­é€”æ— æ³•æš‚åœ

---

### åœºæ™¯ 2: åˆ†æ­¥æ‰§è¡Œï¼ˆçµæ´»ï¼‰

**é€æ­¥è¿è¡Œå„ä¸ªè„šæœ¬**ï¼š

```bash
# æ­¥éª¤ 1: ç¯å¢ƒå‡†å¤‡
sudo bash scripts/01-setup-build-env.sh

# æ­¥éª¤ 2: æºä»£ç åŒæ­¥
bash scripts/02-sync-source.sh

# æ­¥éª¤ 3: ç¼–è¯‘
bash scripts/03-build-android.sh

# æ­¥éª¤ 4: ä¼˜åŒ–
bash scripts/04-optimize-output.sh

# æ­¥éª¤ 5: ä¼ è¾“
bash scripts/05-transfer-to-ipad.sh
```

**ä¼˜ç‚¹**ï¼š
- âœ… å¯ä»¥éšæ—¶æš‚åœ
- âœ… å¯ä»¥è·³è¿‡å·²å®Œæˆçš„æ­¥éª¤
- âœ… æ›´å¥½çš„æ§åˆ¶

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦æ‰‹åŠ¨æ‰§è¡Œæ¯ä¸ªæ­¥éª¤

---

### åœºæ™¯ 3: å¢é‡ç¼–è¯‘ï¼ˆå¿«é€Ÿï¼‰

**å¦‚æœå·²ç»ç¼–è¯‘è¿‡ï¼Œåªéœ€é‡æ–°ç¼–è¯‘**ï¼š

```bash
# åªè¿è¡Œç¼–è¯‘æ­¥éª¤
bash scripts/03-build-android.sh

# ä¼˜åŒ–äº§ç‰©
bash scripts/04-optimize-output.sh
```

**é¢„è®¡æ—¶é—´**: 15-60 åˆ†é’Ÿï¼ˆä½¿ç”¨ ccacheï¼‰

---

### åœºæ™¯ 4: ä»…æ›´æ–°æºä»£ç 

**æ›´æ–°åˆ°æœ€æ–°çš„ LineageOS ä»£ç **ï¼š

```bash
# é‡æ–°åŒæ­¥æºä»£ç 
bash scripts/02-sync-source.sh

# é‡æ–°ç¼–è¯‘
bash scripts/03-build-android.sh
```

---

## ğŸ“– è¯¦ç»†è¯´æ˜

### 00-auto-build-all.sh - ä¸€é”®å¼è‡ªåŠ¨åŒ–ç¼–è¯‘

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰ç¼–è¯‘æ­¥éª¤
- ç»Ÿä¸€çš„æ—¥å¿—è®°å½•
- é”™è¯¯å¤„ç†å’Œæ¢å¤
- è¿›åº¦æç¤º

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
sudo bash scripts/00-auto-build-all.sh
```

**äº¤äº’å¼é€‰é¡¹**ï¼š
- ç¡®è®¤å¼€å§‹ç¼–è¯‘
- é€‰æ‹©æ˜¯å¦æ¸…ç†æ—§ç¼–è¯‘äº§ç‰©
- é€‰æ‹©ç¼–è¯‘ç‰ˆæœ¬ï¼ˆuser/userdebugï¼‰
- é€‰æ‹©æ˜¯å¦æ¸…ç†ä¸­é—´æ–‡ä»¶
- é€‰æ‹©æ˜¯å¦ä¼ è¾“åˆ° iPad

**æ—¥å¿—æ–‡ä»¶**ï¼š
```
$HOME/android/logs/auto_build_YYYYMMDD_HHMMSS.log
```

---

### 01-setup-build-env.sh - ç¯å¢ƒå‡†å¤‡

**åŠŸèƒ½**ï¼š
- å®‰è£…æ‰€æœ‰ç¼–è¯‘ä¾èµ–
- é…ç½® Git å’Œ repo å·¥å…·
- è®¾ç½® ccacheï¼ˆ50GBï¼‰
- åˆ›å»ºå·¥ä½œç›®å½•

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
sudo bash scripts/01-setup-build-env.sh
```

**å®‰è£…çš„ç»„ä»¶**ï¼š
- åŸºç¡€ç¼–è¯‘å·¥å…·ï¼ˆGCC, Make, etc.ï¼‰
- Python 3
- OpenJDK 11
- Git + Git LFS
- repo å·¥å…·
- ccache
- é¢å¤–å·¥å…·ï¼ˆvim, tmux, htop, etc.ï¼‰

**å®Œæˆå**ï¼š
```bash
# é‡æ–°åŠ è½½ç¯å¢ƒå˜é‡
source ~/.bashrc
```

---

### 02-sync-source.sh - æºä»£ç åŒæ­¥

**åŠŸèƒ½**ï¼š
- åˆå§‹åŒ– repo
- åŒæ­¥ LineageOS 23.0 æºä»£ç 
- éªŒè¯æºä»£ç å®Œæ•´æ€§

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
bash scripts/02-sync-source.sh
```

**é…ç½®**ï¼š
- åˆ†æ”¯: `lineage-23.0`
- å·¥ä½œç›®å½•: `$HOME/android/lineage`
- å¹¶è¡Œä»»åŠ¡æ•°: è‡ªåŠ¨æ£€æµ‹ï¼ˆæœ€å¤š 4ï¼‰

**ç½‘ç»œè¦æ±‚**ï¼š
- ç¨³å®šçš„äº’è”ç½‘è¿æ¥
- çº¦ 50GB ä¸‹è½½é‡

**é¢„è®¡æ—¶é—´**ï¼š
- å¿«é€Ÿç½‘ç»œ: 2-4 å°æ—¶
- æ…¢é€Ÿç½‘ç»œ: 4-8 å°æ—¶

---

### 03-build-android.sh - ç¼–è¯‘ Android 15

**åŠŸèƒ½**ï¼š
- è®¾ç½®ç¼–è¯‘ç¯å¢ƒ
- é€‰æ‹©ç¼–è¯‘ç›®æ ‡
- æ‰§è¡Œç¼–è¯‘
- éªŒè¯ç¼–è¯‘äº§ç‰©

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
bash scripts/03-build-android.sh
```

**äº¤äº’å¼é€‰é¡¹**ï¼š

1. **æ˜¯å¦æ¸…ç†æ—§ç¼–è¯‘äº§ç‰©ï¼Ÿ**
   - é€‰æ‹© `y`: å®Œæ•´é‡æ–°ç¼–è¯‘ï¼ˆæ…¢ï¼‰
   - é€‰æ‹© `N`: å¢é‡ç¼–è¯‘ï¼ˆå¿«ï¼‰

2. **é€‰æ‹©ç¼–è¯‘ç‰ˆæœ¬**ï¼š
   - `1`: virtio_arm64-userï¼ˆæ¨èï¼Œä½“ç§¯å°ï¼‰
   - `2`: virtio_arm64-userdebugï¼ˆè°ƒè¯•ç‰ˆæœ¬ï¼Œä½“ç§¯å¤§ï¼‰

**ç¼–è¯‘é…ç½®**ï¼š
- ç›®æ ‡: `virtio_arm64`
- å¹¶è¡Œçº¿ç¨‹: è‡ªåŠ¨è®¡ç®—ï¼ˆåŸºäº CPU å’Œå†…å­˜ï¼‰
- ccache: è‡ªåŠ¨å¯ç”¨

**ç¼–è¯‘äº§ç‰©**ï¼š
```
$HOME/android/lineage/out/target/product/virtio_arm64/
â”œâ”€â”€ system.img
â”œâ”€â”€ vendor.img
â”œâ”€â”€ boot.img
â”œâ”€â”€ ramdisk.img
â””â”€â”€ VirtuaMachine-utm-*.zip
```

**æ—¥å¿—æ–‡ä»¶**ï¼š
```
$HOME/android/build_YYYYMMDD_HHMMSS.log
```

**é¢„è®¡æ—¶é—´**ï¼š
- 4 æ ¸ 8GB: 6-8 å°æ—¶
- 8 æ ¸ 16GB: 2-4 å°æ—¶
- 16 æ ¸ 32GB: 1-2 å°æ—¶

---

### 04-optimize-output.sh - äº§ç‰©ä¼˜åŒ–

**åŠŸèƒ½**ï¼š
- å‹ç¼©é•œåƒæ–‡ä»¶ï¼ˆqcow2 æ ¼å¼ï¼‰
- å¤åˆ¶å…³é”®æ–‡ä»¶
- ç”Ÿæˆæ ¡éªŒå’Œ
- æ¸…ç†ä¸­é—´æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
bash scripts/04-optimize-output.sh
```

**äº¤äº’å¼é€‰é¡¹**ï¼š

1. **æ˜¯å¦æ¸…ç†ä¸­é—´æ–‡ä»¶ï¼Ÿ**
   - é€‰æ‹© `y`: é‡Šæ”¾ 50-100GB ç©ºé—´
   - é€‰æ‹© `N`: ä¿ç•™ï¼Œä¾¿äºå¢é‡ç¼–è¯‘

2. **æ˜¯å¦æ¸…ç† ccacheï¼Ÿ**
   - é€‰æ‹© `y`: æ¸…ç©ºç¼“å­˜
   - é€‰æ‹© `N`: ä¿ç•™ç¼“å­˜

**ä¼˜åŒ–æ•ˆæœ**ï¼š
- åŸå§‹å¤§å°: ~10GB
- ä¼˜åŒ–å: 3-5GB
- èŠ‚çœ: 50-70%

**ä¼˜åŒ–äº§ç‰©**ï¼š
```
$HOME/android/optimized_YYYYMMDD_HHMMSS/
â”œâ”€â”€ system.qcow2 (å‹ç¼©åçš„ç³»ç»Ÿé•œåƒ)
â”œâ”€â”€ vendor.img
â”œâ”€â”€ boot.img
â”œâ”€â”€ ramdisk.img
â”œâ”€â”€ VirtuaMachine-utm-*.zip (å¦‚æœå­˜åœ¨)
â”œâ”€â”€ checksums.md5
â””â”€â”€ checksums.sha256
```

---

### 05-transfer-to-ipad.sh - æ–‡ä»¶ä¼ è¾“

**åŠŸèƒ½**ï¼š
- å¯åŠ¨ HTTP æ–‡ä»¶æœåŠ¡å™¨
- æ˜¾ç¤ºè®¿é—®åœ°å€
- æä¾›ä¼ è¾“æŒ‡å—

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
bash scripts/05-transfer-to-ipad.sh
```

**å·¥ä½œæµç¨‹**ï¼š

1. è„šæœ¬è‡ªåŠ¨æŸ¥æ‰¾æœ€æ–°çš„ä¼˜åŒ–ç›®å½•
2. è·å–æœ¬æœº IP åœ°å€
3. æŸ¥æ‰¾å¯ç”¨ç«¯å£ï¼ˆ8000, 8080, 8888, 9000ï¼‰
4. å¯åŠ¨ HTTP æœåŠ¡å™¨

**åœ¨ iPad ä¸Š**ï¼š

1. æ‰“å¼€ Safari æµè§ˆå™¨
2. è®¿é—®æ˜¾ç¤ºçš„åœ°å€ï¼ˆå¦‚ `http://192.168.1.100:8000/`ï¼‰
3. ä¸‹è½½éœ€è¦çš„æ–‡ä»¶
4. ä½¿ç”¨ Files åº”ç”¨è§£å‹ ZIP æ–‡ä»¶
5. åœ¨ UTM ä¸­å¯¼å…¥è™šæ‹Ÿæœº

**åœæ­¢æœåŠ¡å™¨**ï¼š
- æŒ‰ `Ctrl+C`

---

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰ç¼–è¯‘ç›®æ ‡

ç¼–è¾‘ `scripts/03-build-android.sh`ï¼š

```bash
# ä¿®æ”¹é»˜è®¤ç›®æ ‡
BUILD_TARGET="virtio_arm64"  # æˆ– virtio_x86_64
BUILD_VARIANT="user"         # æˆ– userdebug, eng
```

### è‡ªå®šä¹‰ ccache å¤§å°

ç¼–è¾‘ `scripts/01-setup-build-env.sh`ï¼š

```bash
# ä¿®æ”¹ ccache å¤§å°ï¼ˆé»˜è®¤ 50GBï¼‰
sudo -u $REAL_USER ccache -M 100G
```

### è‡ªå®šä¹‰å¹¶è¡Œç¼–è¯‘çº¿ç¨‹æ•°

ç¼–è¾‘ `scripts/03-build-android.sh`ï¼š

```bash
# å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šçº¿ç¨‹æ•°
JOBS=16  # è€Œä¸æ˜¯è‡ªåŠ¨è®¡ç®—
```

---

## ğŸ“Š èµ„æºéœ€æ±‚

### æœ€ä½é…ç½®

- **CPU**: 4 æ ¸
- **å†…å­˜**: 8GB
- **å­˜å‚¨**: 300GB
- **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥

### æ¨èé…ç½®

- **CPU**: 8+ æ ¸
- **å†…å­˜**: 16-32GB
- **å­˜å‚¨**: 500GB+ SSD
- **ç½‘ç»œ**: é«˜é€Ÿäº’è”ç½‘è¿æ¥

### ç†æƒ³é…ç½®

- **CPU**: 16+ æ ¸
- **å†…å­˜**: 32-64GB
- **å­˜å‚¨**: 1TB+ NVMe SSD
- **ç½‘ç»œ**: åƒå…†ç½‘ç»œ

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: è„šæœ¬æ‰§è¡Œå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ£€æŸ¥è„šæœ¬æƒé™
chmod +x scripts/*.sh

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f $HOME/android/logs/auto_build_*.log
```

### é—®é¢˜ 2: ç£ç›˜ç©ºé—´ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ¸…ç†ç¼–è¯‘ä¸­é—´æ–‡ä»¶
cd ~/android/lineage
make clean

# æ¸…ç† ccache
ccache -C
```

### é—®é¢˜ 3: ç½‘ç»œè¿æ¥è¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# é‡æ–°åŒæ­¥æºä»£ç 
cd ~/android/lineage
repo sync --force-sync
```

### é—®é¢˜ 4: ç¼–è¯‘å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æŸ¥çœ‹ç¼–è¯‘æ—¥å¿—
tail -f $HOME/android/build_*.log

# é‡æ–°å®‰è£…ä¾èµ–
sudo bash scripts/01-setup-build-env.sh

# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
cd ~/android/lineage
make clean
bash scripts/03-build-android.sh
```

---

## ğŸ“ æ—¥å¿—æ–‡ä»¶

### ä¸»æ—¥å¿—

```
$HOME/android/logs/auto_build_YYYYMMDD_HHMMSS.log
```

åŒ…å«æ‰€æœ‰æ­¥éª¤çš„å®Œæ•´æ—¥å¿—ã€‚

### ç¼–è¯‘æ—¥å¿—

```
$HOME/android/build_YYYYMMDD_HHMMSS.log
```

åŒ…å«è¯¦ç»†çš„ç¼–è¯‘è¾“å‡ºã€‚

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹
tail -f $HOME/android/logs/auto_build_*.log

# æœç´¢é”™è¯¯
grep -i error $HOME/android/logs/auto_build_*.log
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. ä½¿ç”¨ tmux æˆ– screen

**é¿å… SSH æ–­å¼€å¯¼è‡´ç¼–è¯‘ä¸­æ–­**ï¼š

```bash
# å®‰è£… tmux
sudo apt install tmux

# å¯åŠ¨ tmux ä¼šè¯
tmux new -s android-build

# è¿è¡Œç¼–è¯‘è„šæœ¬
sudo bash scripts/00-auto-build-all.sh

# åˆ†ç¦»ä¼šè¯: Ctrl+B, ç„¶åæŒ‰ D
# é‡æ–°è¿æ¥: tmux attach -t android-build
```

### 2. å®šæœŸå¤‡ä»½

**å¤‡ä»½é‡è¦æ–‡ä»¶**ï¼š

```bash
# å¤‡ä»½æºä»£ç 
tar -czf android-source-backup.tar.gz ~/android/lineage

# å¤‡ä»½ç¼–è¯‘äº§ç‰©
tar -czf android-output-backup.tar.gz ~/android/optimized_*
```

### 3. ä½¿ç”¨å¢é‡ç¼–è¯‘

**åŠ å¿«é‡æ–°ç¼–è¯‘é€Ÿåº¦**ï¼š

```bash
# ä¸è¦æ¸…ç†æ—§ç¼–è¯‘äº§ç‰©
# ç›´æ¥è¿è¡Œç¼–è¯‘è„šæœ¬
bash scripts/03-build-android.sh
```

### 4. ç›‘æ§èµ„æºä½¿ç”¨

**å®æ—¶ç›‘æ§**ï¼š

```bash
# å®‰è£… htop
sudo apt install htop

# è¿è¡Œ htop
htop
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICKSTART.md)
- [å®Œæ•´ç¼–è¯‘æŒ‡å—](BUILD_GUIDE.md)
- [ä¼˜åŒ–è°ƒä¼˜æŒ‡å—](OPTIMIZATION_GUIDE.md)
- [æ•…éšœæ’æŸ¥æŒ‡å—](TROUBLESHOOTING.md)
- [å¸¸è§é—®é¢˜è§£ç­”](FAQ.md)

---

**æœ€åæ›´æ–°**: 2026å¹´1æœˆ27æ—¥  
**ç»´æŠ¤è€…**: Manus AI
